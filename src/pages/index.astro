---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 6);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<!-- Hero Section -->
			<section class="hero">
				<div class="hero-content">
					<p class="hero-intro">Welcome to the workshop of</p>
					<h1 class="hero-title">Ralph Unlimited</h1>
					<p class="hero-description">
						A place where dreams are made. I build games, tinker with code, 
						and occasionally get my hands dirty with real-world projects. 
						This is where I share the journey.
					</p>
					<div class="hero-actions">
						<a href="/blog/" class="btn">
							Browse the Journal
						</a>
						<a href="/games/retro-cruiser/index.html" class="btn btn-secondary">
							Play Retro Cruiser
						</a>
					</div>
				</div>
				<div class="hero-decoration">
					<span class="deco-line"></span>
					<span class="deco-symbol">◈</span>
					<span class="deco-line"></span>
				</div>
			</section>

			<!-- Featured Posts -->
			<section class="posts-section">
				<header class="section-header">
					<h2 class="section-title">Recent Writings</h2>
					<a href="/blog/" class="view-all">
						View all entries →
					</a>
				</header>
				
				<div class="posts-grid">
					{posts.map((post, index) => (
						<article class="post-card" style={`animation-delay: ${index * 0.08}s`}>
							<div class="post-meta">
								<time class="post-date">
									<FormattedDate date={post.data.pubDate} />
								</time>
								{post.data.categories?.[0] && (
									<span class="post-category">{post.data.categories[0]}</span>
								)}
							</div>
							<h3 class="post-title">
								<a href={`/blog/${post.data.slug || post.id}/`}>
									{post.data.title}
								</a>
							</h3>
							<p class="post-excerpt">{post.data.description}</p>
						</article>
					))}
				</div>
			</section>

			<!-- Game Feature -->
			<section class="game-feature">
				<div class="game-content">
					<span class="game-label">Featured Creation</span>
					<h2>Retro Cruiser</h2>
					<p>
						A space shooter built with Phaser.js. Navigate the cosmos, 
						blast through asteroids, and chase that high score. 
						Playable right here in your browser.
					</p>
					<a href="/games/retro-cruiser/index.html" class="btn">
						Launch Game →
					</a>
				</div>
				<div class="game-image">
					<img src="/images/uploads/2025/03/hero.webp" alt="Retro Cruiser Game" />
				</div>
			</section>
		</main>
		<Footer />

		<style>
			/* Hero Section */
			.hero {
				padding: var(--space-2xl) var(--space-lg);
				text-align: center;
				max-width: 800px;
				margin: 0 auto;
			}

			.hero-content {
				animation: fade-in 0.8s ease forwards;
			}

			.hero-intro {
				font-family: var(--font-mono);
				font-size: 0.85rem;
				text-transform: uppercase;
				letter-spacing: 0.15em;
				color: var(--accent-secondary);
				margin-bottom: var(--space-sm);
			}

			.hero-title {
				font-size: clamp(2.5rem, 7vw, 4rem);
				margin-bottom: var(--space-lg);
				color: var(--text-primary);
			}

			.hero-description {
				font-size: 1.2rem;
				line-height: 1.8;
				color: var(--text-secondary);
				max-width: 580px;
				margin: 0 auto var(--space-xl);
			}

			.hero-actions {
				display: flex;
				gap: 1rem;
				justify-content: center;
				flex-wrap: wrap;
			}

			.hero-decoration {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: var(--space-md);
				margin-top: var(--space-2xl);
				opacity: 0.4;
			}

			.deco-line {
				width: 60px;
				height: 1px;
				background: var(--accent-tertiary);
			}

			.deco-symbol {
				color: var(--accent-tertiary);
				font-size: 0.9rem;
			}

			/* Posts Section */
			.posts-section {
				padding: var(--space-xl) var(--space-lg) var(--space-2xl);
				max-width: 1100px;
				margin: 0 auto;
			}

			.section-header {
				display: flex;
				align-items: baseline;
				justify-content: space-between;
				margin-bottom: var(--space-xl);
				padding-bottom: var(--space-md);
				border-bottom: var(--border-subtle);
				flex-wrap: wrap;
				gap: 1rem;
			}

			.section-title {
				font-size: 1.5rem;
				margin: 0;
			}

			.view-all {
				font-family: var(--font-display);
				font-size: 0.9rem;
				color: var(--text-muted);
			}

			.view-all:hover {
				color: var(--accent-primary);
			}

			.posts-grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
				gap: var(--space-lg);
			}

			.post-card {
				padding: var(--space-lg);
				background: var(--bg-card);
				border: var(--border-subtle);
				border-radius: var(--radius-lg);
				transition: var(--transition-base);
				animation: fade-in 0.6s ease forwards;
				opacity: 0;
			}

			.post-card:hover {
				border-color: var(--accent-tertiary);
				box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
				transform: translateY(-2px);
			}

			.post-meta {
				display: flex;
				align-items: center;
				gap: var(--space-md);
				margin-bottom: var(--space-sm);
			}

			.post-date {
				font-family: var(--font-mono);
				font-size: 0.75rem;
				color: var(--text-muted);
			}

			.post-category {
				font-family: var(--font-mono);
				font-size: 0.65rem;
				text-transform: uppercase;
				letter-spacing: 0.08em;
				padding: 0.2rem 0.5rem;
				background: rgba(212, 165, 116, 0.1);
				border-radius: var(--radius-sm);
				color: var(--accent-secondary);
			}

			.post-title {
				font-family: var(--font-display);
				font-size: 1.15rem;
				font-weight: 600;
				margin-bottom: var(--space-sm);
				line-height: 1.35;
			}

			.post-title a {
				color: var(--text-primary);
				text-decoration: none;
			}

			.post-card:hover .post-title a {
				color: var(--accent-primary);
			}

			.post-excerpt {
				font-size: 0.95rem;
				color: var(--text-muted);
				margin: 0;
				display: -webkit-box;
				-webkit-line-clamp: 3;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}

			/* Game Feature */
			.game-feature {
				padding: var(--space-2xl) var(--space-lg);
				max-width: 1100px;
				margin: 0 auto;
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: var(--space-xl);
				align-items: center;
			}

			.game-label {
				font-family: var(--font-mono);
				font-size: 0.75rem;
				text-transform: uppercase;
				letter-spacing: 0.12em;
				color: var(--accent-secondary);
			}

			.game-content h2 {
				font-size: 2rem;
				margin: var(--space-sm) 0 var(--space-md);
			}

			.game-content p {
				color: var(--text-secondary);
				margin-bottom: var(--space-lg);
			}

			.game-image {
				display: flex;
				justify-content: center;
			}

			.game-image img {
				max-width: 100%;
				border-radius: var(--radius-lg);
				border: var(--border-subtle);
				box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
			}

			@media (max-width: 800px) {
				.game-feature {
					grid-template-columns: 1fr;
					text-align: center;
				}

				.game-image {
					order: -1;
				}
			}

			@media (max-width: 640px) {
				.hero {
					padding: var(--space-xl) var(--space-md);
				}

				.posts-grid {
					grid-template-columns: 1fr;
				}
			}
		</style>
	</body>
</html>
